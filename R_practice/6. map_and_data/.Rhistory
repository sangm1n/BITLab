ds[2,3] <- NA
ds[3,1] <- NA
ds[2,4] <- NA
ds[4,3] <- NA
head(ds)
count_na <- function(x) {
return(sum(is.na(x)))
}
apply(ds, 2, FUN=count_na)
ds[!complete.cases(ds), ]
sum(rowSums(is.na(ds)) > 0)
ds.new <- ds[complete.cases(ds), ]
ds.new
###
st <- data.frame(state.x77)
head(st)
par(mfrow=c(2, 4))
for(i in 1:ncol(st)) {
boxplot(st[, i], main=colnames(st[i]))
}
par(mfrow=c(1, 1))
head(st)
val <- boxplot.stats(st$Population)$out
st$Population[st$Population %in% val] <- NA
val <- boxplot.stats(st$Income)$out
st$Income[st$Income %in% val] <- NA
val <- boxplot.stats(st$Area)$out
st$Area[st$Area %in% val] <- NA
st.2 <- st[!complete.cases(st), ]
### 6
setwd("C:\\Users\\sangmin\\Desktop\\code\\RStudio\\R_practice\\6. map_and_data")
data <- read.csv("도로교통공단_시도_시군구별_월별_교통사고(2018).csv")
seoul <- subset(data, 시도=="서울")
View(seoul)
summary(seoul)
View(data)
seoul <- subset(data, select="발생건수", 시도=="서울")
summary(seoul)
seoul
seoul <- subset(data, select=c(발생건수), 시도=="서울")
seoul
summary(seoul)
str(state.x77)
st <- data.frame(state.x77)
head(st)
subset(st, select="Income", Frost >= 50)
seoul <- subset(data, select=c(발생건수), 시도!="서울")
seoul
seoul <- subset(data, select=c(발생건수), subset("시도" == "서울"))
seoul <- subset(data, select=c(발생건수), "시도" == "서울")
seoul
seoul <- subset(data, select=c(발생건수), 시도=="서울")
seoul
seoul <- subset(data, 시도=="서울")
seoul
seoul <- subset(data, select=c("시도", "시군구", "발생건수")
, 시도=="서울")
seoul
seoul <- subset(data,
select=c("시도", "시군구", "월", "발생건수")
, 시도=="서울")
seoul
seoul <- subset(data,
select=c("시군구", "월", "발생건수")
, 시도=="서울")
summary(seoul)
seoul
str(seoul)
split(seoul, seoul$시군구)
head(seoul)
seoul$시군구구
seoul$시군구
subset(seoul, 시군구=="강남구")
sum(subset(seoul, select="발생건수", 시군구=="강남구"))
apply(seoul[, "시군구"], 1, sum)
seoul[, "시군구"]
apply(seoul[, "발생건수"], 1, sum)
seoul[, "발생건수"]
apply(subset(seoul, select="발생건수", 시군구=="강남구"), 1, sum)
apply(subset(seoul, select="발생건수", 시군구=="강남구"), 2, sum)
apply(seoul[, "발생건수"], 2, sum)
apply(subset(seoul, select="발생건수", 시군구=="강남구"), 2, sum)
sum(subset(seoul, select="발생건수", 시군구=="강남구"))
source('C:/Users/sangmin/Desktop/code/RStudio/R_practice/CH09.R', encoding = 'UTF-8', echo=TRUE)
seoul <- subset(data,
select=c("시군구", "월", "발생건수")
, 시도=="서울")
### 6
setwd("C:\\Users\\sangmin\\Desktop\\code\\RStudio\\R_practice\\6. map_and_data")
### 6
setwd("C:\\Users\\sangmin\\Desktop\\code\\RStudio\\R_practice\\6. map_and_data")
data <- read.csv("도로교통공단_시도_시군구별_월별_교통사고(2018).csv")
seoul <- subset(data,
select=c("시군구", "월", "발생건수"),
시도=="서울")
seoul
nrow(seoul)
seq(1, 12)
unique(seoul)
unique(seoul$시군구)
unique(seoul$시군구)
m <- 1
n <- 12
for (i in 1:25) {
i <- data.frame(seoul[m:n, ])
m <- m + 12
n <- n + 12
}
1
i.data <- data.frame(seoul[m:n, ])
m <- 1
n <- 12
for (i in 1:25) {
i.data <- data.frame(seoul[m:n, ])
m <- m + 12
n <- n + 12
}
1.data
for (i in 1:25) {
datai <- data.frame(seoul[m:n, ])
m <- m + 12
n <- n + 12
}
m <- 1
n <- 12
for (i in 1:25) {
datai <- data.frame(seoul[m:n, ])
m <- m + 12
n <- n + 12
}
i
datai
data.frame(seoul)
str(seoul)
str(data.frame(seoul))
seoul <- subset(data,
select=c("시군구", "월", "발생건수"),
시도=="서울")
seoul
seoul$종로구
seoul["시군구", ]
seoul[, "시군구"]
seoul[, "시군구"=="강남구"]
seoul <- subset(data,
select=c("시군구", "월", "발생건수"),
시도=="서울")
seoul
aggregate(seoul, by=list(seoul$시군구), sum)
aggregate(seoul$발생건수, by=list(seoul$시군구), sum)
data
aggregate(data$발생건수, by=list(data$시군구), sum)
aggregate(data$"발생건수", by=list(data$시군구), sum)
aggregate(data$"발생건수", by=list(data$"시군구"), sum)
city <- aggregate(data$"발생건수", by=list(data$"시군구"), sum)
city
View(city)
city <- aggregate(data$"발생건수", by=list(시=data$"시군구"), sum)
city
View(city)
seoul <- subset(data,
select=c("시군구", "월", "발생건수"),
시도=="서울")
aggregate(seoul$"발생건수", by=list(시군구=seoul$"시군구"), sum)
aggregate(발생건수=seoul$"발생건수", by=list(시군구=seoul$"시군구"), sum)
aggregate(발생건수=seoul$"발생건수", by=list(시군구=seoul$"시군구"), FUN=sum)
aggregate(list(건수=seoul$"발생건수"), by=list(시군구=seoul$"시군구"), sum)
aggregate(list(발생생건수=seoul$"발생건수"), by=list(시군구=seoul$"시군구"), sum)
aggregate(list(발생건수=seoul$"발생건수"), by=list(시군구=seoul$"시군구"), sum)
### 6
setwd("C:\\Users\\sangmin\\Desktop\\code\\RStudio\\R_practice\\6. map_and_data")
data <- read.csv("도로교통공단_시도_시군구별_월별_교통사고(2018).csv")
seoul <- subset(data,
select=c("시군구", "월", "발생건수"),
시도=="서울")
gu.data <- aggregate(list(발생건수=seoul$"발생건수"),
by=list(시군구=seoul$"시군구"), sum)
gu.data
str(gu.data)
library(ggmap)
library(ggplot2)
register_google("AIzaSyAU_3MpDapUjPlkDXFlNskojuSN8hKx1o4")
gu.data$시군구
gu.data$:
gu.data$"시군구"
gu.names <- gu.data$"시군구"
gu.names
gu.names <- as.vector(gu.data$"시군구")
gu.names
gc <- geocode(enc2utf8(gu.names))
gc
cen <- c(mean(gc$lon), mean(gc$lat))
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=6, marker=gc)
ggmap(map)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=9, marker=gc)
ggmap(map)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=10, marker=gc)
ggmap(map)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=11, marker=gc)
ggmap(map)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=12, marker=gc)
ggmap(map)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=13, marker=gc)
gmap <- ggmap(map)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=13, size=c(640,640))
gmap <- ggmap(map)
head(gu.data)
dt <- data.frame(gu.data, gc)
head(dt)
gmap + geom_point(data=dt, aes(x=lon, y=lat),
labels="발생건수")
gmap + geom_point(data=dt, aes(x=lon, y=lat,
size="발생건수"),
alpha=0.05)
gmap + geom_point(data=dt, aes(x=lon, y=lat,
size=발생건수),
alpha=0.05)
gmap + geom_point(data=dt, aes(x=lon, y=lat,
size=발생건수),
alpha=0.5)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=11, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt, aes(x=lon, y=lat,
size=발생건수),
alpha=0.5, color="red")
gmap + geom_point(data=dt, aes(x=lon, y=lat,
size=발생건수),
alpha=0.5, color="red") +
scale_size_continuous(range(1, 15))
gmap + geom_point(data=dt, aes(x=lon, y=lat,
size=발생건수),
alpha=0.5, color="red") +
scale_size_continuous(range(1, 20))
gmap + geom_point(data=dt, aes(x=lon, y=lat,
size=발생건수),
alpha=0.5, color="red") +
scale_size_continuous(range(5, 20))
gmap + geom_point(data=dt, aes(x=lon, y=lat,
size=발생건수),
alpha=0.5, color="red") +
scale_size_continuous(range=c(5, 20))
gmap + geom_point(data=dt, aes(x=lon, y=lat,
size=발생건수),
alpha=0.5, color="red") +
scale_size_continuous(range=c(1, 15))
head(data)
View(data)
unique(data$"시도")
data.2 <- subset(data, 시도!="세종")
unique(data.2$"시도")
View(data.2)
시도!="세종")
data.2 <- subset(data,
select=c("시도", "월", "사망자수"),
시도!="세종")
head(data.2)
si.data <- aggregate(list(사망자수=data.2$"사망자수"),
by=list(시도=data.2$"시도"), sum)
si.data
si.names <- as.vector(si.data$"시도")
gc <- geocode(enc2utf8(si.names))
cen <- c(mean(gc$lon), mean(gc$lat))
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=8, size=c(640,640))
ggmap(map)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
ggmap(map)
gmap <- ggmap(map)
dt <- data.frame(data.2, gc)
dt <- data.frame(si.data, gc)
dt
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black")
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.05, color="black")
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_color_continuous(range=c(1,15))
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_size_continuous(range=c(1, 15))
cen <- c(mean(gc$lon)+10, mean(gc$lat))
dt <- data.frame(si.data, gc)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_size_continuous(range=c(1, 15))
gc <- geocode(enc2utf8(si.names))
cen <- c(mean(gc$lon)+10, mean(gc$lat))
dt <- data.frame(si.data, gc)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_size_continuous(range=c(1, 15))
cen <- c(mean(gc$lon), mean(gc$lat))
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_size_continuous(range=c(1, 15))
cen <- c(mean(gc$lon)+10, mean(gc$lat))
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_size_continuous(range=c(1, 15))
cen <- c(mean(gc$lon), mean(gc$lat)+10)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_size_continuous(range=c(1, 15))
cen <- c(mean(gc$lon), mean(gc$lat)+5)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_size_continuous(range=c(1, 15))
cen <- c(mean(gc$lon), mean(gc$lat)+1)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_size_continuous(range=c(1, 15))
cen <- c(mean(gc$lon), mean(gc$lat)-1)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_size_continuous(range=c(1, 15))
cen <- c(mean(gc$lon), mean(gc$lat)-0.5)
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=사망자수),
alpha=0.5, color="black") +
scale_size_continuous(range=c(1, 15))
head(data)
### 8
setwd("C:\\Users\\sangmin\\Desktop\\code\\RStudio\\R_practice\\6. map_and_data")
data <- read.csv("도로교통공단_시도_시군구별_월별_교통사고(2018).csv")
head(data)
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
"월" == 7 | "월 == 8" & 시도!="세종")
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
월 == 7 | 월 == 8 & 시도!="세종")
head(data.2)
data.2
data <- read.csv("도로교통공단_시도_시군구별_월별_교통사고(2018).csv")
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
월 == 7 | 월 == 8 & 시도!="세종")
data.2
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종")
data.2
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & 월==7)
data.2
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & 월=="7월")
data.2
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & 월=="07월")
data.2
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & 월=="07월" | 월=="08월")
data.2
si.data <- aggregate(list(시도=data.2$"시도"),
by=list(부상자수=data.2$"부상자수"), sum)
si.data <- aggregate(list(부상자수=data.2$"부상자수"),
by=list(시도=data.2$"시도"), sum)
si.data
dt
data <- read.csv("도로교통공단_시도_시군구별_월별_교통사고(2018).csv")
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & 월=="07월" | 월=="08월")
data.2
si.data <- aggregate(list(부상자수=data.2$"부상자수"),
by=list(시도=data.2$"시도"), sum)
si.data
si.data
### 7
setwd("C:\\Users\\sangmin\\Desktop\\code\\RStudio\\R_practice\\6. map_and_data")
data <- read.csv("도로교통공단_시도_시군구별_월별_교통사고(2018).csv")
data.2 <- subset(data,
select=c("시도", "월", "사망자수"),
시도!="세종")
si.data <- aggregate(list(사망자수=data.2$"사망자수"),
by=list(시도=data.2$"시도"), sum)
si.data
### 8
setwd("C:\\Users\\sangmin\\Desktop\\code\\RStudio\\R_practice\\6. map_and_data")
data <- read.csv("도로교통공단_시도_시군구별_월별_교통사고(2018).csv")
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & 월=="07월" | 월=="08월")
si.data <- aggregate(list(부상자수=data.2$"부상자수"),
by=list(시도=data.2$"시도"), sum)
si.data
data.2$시도
data.2
View(data.2)
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & 월=="07월" & 월=="08월")
data.2
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & 월=="07월" & 월=="08월")
data.2
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & 월=="07월" | 월=="08월")
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종", 월=="07월" | 월=="08월")
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
c(시도!="세종", 월=="07월" | 월=="08월"))
data.2
si.data <- aggregate(list(부상자수=data.2$"부상자수"),
by=list(시도=data.2$"시도"), sum)
si.data
### 8
setwd("C:\\Users\\sangmin\\Desktop\\code\\RStudio\\R_practice\\6. map_and_data")
data <- read.csv("도로교통공단_시도_시군구별_월별_교통사고(2018).csv")
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
c(시도!="세종", 월=="07월" | 월=="08월"))
si.data <- aggregate(list(부상자수=data.2$"부상자수"),
by=list(시도=data.2$"시도"), sum)
si.data
data.2
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
c(시도!="세종", 월=="07월", 월=="08월"))
data.2
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & (월=="07월" | 월=="08월"))
data.2
si.data <- aggregate(list(부상자수=data.2$"부상자수"),
by=list(시도=data.2$"시도"), sum)
si.data
data.2
### 8
setwd("C:\\Users\\sangmin\\Desktop\\code\\RStudio\\R_practice\\6. map_and_data")
data <- read.csv("도로교통공단_시도_시군구별_월별_교통사고(2018).csv")
data.2 <- subset(data,
select=c("시도", "월", "부상자수"),
시도!="세종" & (월=="07월" | 월=="08월"))
si.data <- aggregate(list(부상자수=data.2$"부상자수"),
by=list(시도=data.2$"시도"), sum)
si.data
library(ggmap)
library(ggplot2)
register_google("AIzaSyAU_3MpDapUjPlkDXFlNskojuSN8hKx1o4")
si.names <- as.vector(si.data$"시도")
gc <- geocode(enc2utf8(si.names))
cen <- c(mean(gc$lon), mean(gc$lat))
si.data
dt <- data.frame(si.data, gc)
dt
map <- get_googlemap(center=cen, maptype="roadmap",
zoom=7, size=c(640,640))
gmap <- ggmap(map)
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=부상자수))
gmap + geom_point(data=dt,
aes(x=lon, y=lat, size=부상자수),
alpha=0.5, color="blue") +
scale_size_continuous(range=c(1, 15))
