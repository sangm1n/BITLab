summary(mod2)
### 5
library(mlbench)
data(BostonHousing)
B.data <- BostonHousing[-4]
model <- lm(medv~., data=B.data)
summary(model)
mod2 <- stepAIC(model)
help(stepAIC)
install.packages("stepAIC")
### 5
library(MASS)
model <- lm(medv~., data=B.data)
summary(model)
mod2 <- stepAIC(model)
summary(mod2)
model <- lm(mpg~., data=mtcars)
summary(model)
mod2 <- stepAIC(model)
summary(mod2)
#
mydata <- read.csv("https://stats.idre.ucla.edu/stat/data/binary.csv")
model <- glm(admit~., data=mydata)
test <- mydata[-1]
pred <- predict(model, test)
pred <- round(pred, 0)
answer <- mydata[, 1]
acc <- mean(answer == pred)
acc
# logistic regression
library(mlbench)
dt <- data.frame(PimaIndiansDiabetes)
# logistic regression
library(mlbench)
dt <- data.frame(PimaIndiansDiabetes)
library(mlbench)
data(Glass)
set.seed(100)
train.cnt <- sample(1:nrow(Glass), size=nrow(Glass)*0.6, replace=F)
train.cnt <- sort(train.cnt)
train <- Glass[train.cnt, ]
test <- Glass[-train.cnt, ]
train$Type <- as.integer(train$Type)
model <- glm(Type~., data=train)
pred <- predict(model, test)
pred <- round(pred, 0)
answer <- as.integer(test$Type)
acc <- mean(pred == answer)
acc
summary(iris)
str(iris)
x5 <- rnorm(100000)
x5
mean(x5)
x5 <- rnorm(100000)
mean(x5)
x5 <- rnorm(100000)
mean(x5)
x5 <- rnorm(100000)
mean(x5)
x5 <- rnorm(100000)
mean(x5)
a <- "Abc"
b <- "ABC"
a == b
x <- seq(0, 10, 0.4)
x
mean(x)
y <- x[5:]
y
x[2]
x[5:]
x[:3]
length(x)
x[0]
x[1]
x[6:26]
x
mean(x[6:26])
cars1
library(ggplot2)
cars1 <- dataframe((1,2,3), (249,67,75))
cars1 <- dataframe(c[1,2,3], c[249,67,75])
cars1 <- data.frame(c[1,2,3], c[249,67,75])
help("data.frame")
x <- c[1,2,3]
x <- c(1,2,3)
cars1 <- data.frame(x, c(249,67,75))
cars1
cars1 <- data.frame(c(1,249), c(2,67), c(3,75))
cars1
ggplot(car, aes(x=wt, y=mpg)) +
geom_point(shpae=1) +
geom_smooth(method=lm)
ggplot(mtcar, aes(x=wt, y=mpg)) +
geom_point(shpae=1) +
geom_smooth(method=lm)
mtcars
ggplot(mtcars, aes(x=wt, y=mpg)) +
geom_point(shpae=1) +
geom_smooth(method=lm)
par(mfrow=c(1,1), mar=c(2,2,2,2))
map("state", "Texas")
summary(mtcars)
table(mtcars)
View(top10)
setwd("C:/Users/sangmin/Desktop/github/RStudio/R_markdown/report1")
library(ggplot2)
library(dplyr)
library(ggmap)
crime_2015 <- read.csv("2015년 범죄발생지.csv", header=T)
crime_2016 <- read.csv("2016년 범죄발생지.csv", header=T)
crime_2017 <- read.csv("2017년 범죄발생지.csv", header=T)
years <- c("2015", "2016", "2017")
crime_total <- NULL
for (i in 1:length(years)) {
filename <- paste(years[i], "년 범죄발생지.csv", sep="")
ds <- read.csv(filename)
ds <- data.frame(ds)
ds$수집년월 <- years[i]
crime_total <- rbind(crime_total, ds)
}
crime_total$합계 <- rowSums(crime_total[,-c(1,2,90)])
big_crime <- aggregate(합계~범죄대분류,
data=crime_total,
FUN=sum)
big_crime <- big_crime[order(big_crime$합계, decreasing=T), ]
top10 <- big_crime[1:10, ]
top10
View(top10)
ggplot(top10, aes(x=범죄대분류, y=합계)) +
geom_bar(stat="identity", width=0.7, fill="red") +
ggtitle("범죄대분류별 범죄 수") +
theme(plot.title = element_text(color="black", size=14, face="bold"))
ggplot(top10, aes(x=reorder(범죄대분류, -합계), y=합계)) +
geom_bar(stat="identity", width=0.7, fill="red") +
ggtitle("범죄대분류별 범죄 수") +
theme(plot.title = element_text(color="black", size=14, face="bold"))
ggplot(top10, aes(x=reorder(범죄대분류, -합계), y=합계)) +
geom_bar(stat="identity", width=0.7, fill="red") +
ggtitle("범죄대분류별 범죄 수") +
theme(plot.title = element_text(color="black", size=14, face="bold")) +
labs(x="범죄대분류", y="범죄 수")
mid_crime <- aggregate(합계~범죄중분류,
data=crime_total,
FUN=sum)
head(mid_crime)
dim(mid_crime)
View(mid_crime)
mid_crime <- mid_crime[order(mid_crime$합계, decreasing=T), ]
mid_crime <- mid_crime[order(mid_crime$합계, decreasing=T), ]
View(mid_crime)
mid_top10 <- mid_crime[1:10, ]
ggplot(mid_top10, aes(x=reorder(범죄중분류, -합계), y=합계)) +
geom_bar(stat="identity", width=0.7, fill="red") +
ggtitle("범죄대분류별 범죄 수") +
theme(plot.title = element_text(color="black", size=14, face="bold"))
ggplot(mid_top10, aes(x=reorder(범죄중분류, -합계), y=합계)) +
geom_bar(stat="identity", width=0.7, fill="red") +
ggtitle("범죄대분류별 범죄 수") +
theme(plot.title = element_text(color="black", size=14, face="bold")) +
labs(x="범죄중분류", y="범죄 수")
big_crime <- big_crime[order(big_crime$합계, decreasing=T), ]
big_top10 <- big_crime[1:10, ]
bit_top10
big_top10 <- big_crime[1:10, ]
big_top10
ggplot(big_top10, aes(x=reorder(범죄대분류, -합계), y=합계)) +
geom_bar(stat="identity", width=0.7, fill="red") +
ggtitle("범죄대분류별 범죄 수") +
theme(plot.title = element_text(color="black", size=14, face="bold")) +
labs(x="범죄대분류", y="범죄 수")
mid_top10 <- mid_crime[1:10, ]
mid_top10
ggplot(mid_top10, aes(x=reorder(범죄중분류, -합계), y=합계)) +
geom_bar(stat="identity", width=0.7, fill="red") +
ggtitle("범죄대분류별 범죄 수") +
theme(plot.title = element_text(color="black", size=14, face="bold")) +
labs(x="범죄중분류", y="범죄 수")
crime_total["합계", ] <- rowSums(crime_total[, -c(1,2)])
rowSums(crime_total[, -c(1,2)])
rowSums(crime_total[, -1])
rowSums(crime_total[, c(3:90)])
crime_total["합계", ] <- rowSums(crime_total[, -c(1,2, 89)])
is.na(crime_total)
unique(crime_total)
crime_total["합계", ] <- colSums(crime_total[, -c(1,2, 89)])
summary(crime_total)
str(crime_total)
crime_total["합계", ] <- colSums(crime_total[, -c(1,2, 90)])
rowSums(crime_total[, -c(1,2,90)])
crime_total["합계", ] <- colSums(crime_total[, -c(1,2, 90)])
crime_total["합계", ] <- colSums(crime_total[, -c(1,2,90)])
View(crime_total)
sum <- colSums(crime_total[, -c(1,2,90)])
sum
str(sum)
sum[3]
sum[0] <- 0
sum
sum[1] <- 0
sum
sum <- colSums(crime_total[, -c(1,2,90)])
sum <- colSums(crime_total)
sum <- colSums(crime_total[, -c(1,2,90)])
dim(crime_total)
sum <- c(0, 0, colSums(crime_total[, -c(1,2,90)]))
sum
dim(sum)
crime_total["합계", ] <- sum
sum <- c(0, 0, colSums(crime_total[, -c(1,2,90)]), 0)
crime_total["합계", ] <- sum
sum <- colSums(crime_total[, -c(1,2,90)])
dim(crime_total)
sum
str(sum)
sum <- as.list(colSums(crime_total[, -c(1,2,90)]))
sum
str(sum)
sum <- c(0, 0, sum, 0)
sum
crime_total["합계", ] <- sum
sum <- as.int(colSums(crime_total[, -c(1,2,90)]))
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum
sum <- c(0, 0, sum, 0)
crime_total["합계", ] <- sum
View(crime_total)
sum <- c(NA, NA, sum, NA)
crime_total["합계", ] <- sum
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
dim(crime_total)
sum <- c(NA, NA, sum, NA)
crime_total["합계", ] <- sum
sum[90]
sum[91]
sum[90]
sum <- c(NA, NA, sum[-90], NA, sum[90])
crime_total["합계", ] <- sum
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum <- c(NA, NA, sum[-90], NA, sum[90])
crime_total["합계", ] <- sum
sum[90]
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum[90]
sum[89]
sum[88]
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum
crime_total <- NULL
for (i in 1:length(years)) {
filename <- paste(years[i], "년 범죄발생지.csv", sep="")
ds <- read.csv(filename)
ds <- data.frame(ds)
ds$수집년월 <- years[i]
crime_total <- rbind(crime_total, ds)
}
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum
crime_total$합계 <- rowSums(crime_total[,-c(1,2,90)])
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum
sum[88]
total <- sum[88]
d <- c(NA, NA, sum[-88], NA, sum[88])
d
crime_total["합계", ] <- sum
crime_total["합계", ] <- d
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum <- c(NA, NA, sum[-88], NA, sum[88])
crime_total["합계", ] <- sum
crime_total["합계", ]
crime_tot <- crime_total[, -c(1,2,90)]
View(crime_tot)
crime_tot <- crime_total["합계", -c(1,2,90)]
View(crime_tot)
t(crime_tot)
crime_tot <- t(crime_tot)
colnames(crime_tot) <- "범죄 수"
crime_tot
ggplot(crime_tot, aes(x=범죄 수, y=합계)) +
geom_bar(stat="identity", width=0.7, fill="steelblue")
colnames(crime_tot) <- c("지역", "범죄 수")
crime_tot
crime_tot <- crime_total["합계", -c(1,2,90)]
crime_tot
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum <- c(NA, NA, sum[-88], NA, sum[88])
crime_total["합계", ] <- sum
crime_tot
crime_tot <- crime_total["합계", -c(1,2,90)]
crime_tot <- t(crime_tot)
colnames(crime_tot) <- "범죄 수"
crime_tot
crime_tot <- crime_total["합계", -c(1,2,90)]
crime_tot <- t(crime_tot)
crime_tot
crime_tot <- crime_total["합계", -c(1,2,90)]
crime_tot
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum <- c(NA, NA, sum[-88], NA, sum[88])
crime_total["합계", ] <- sum
crime_tot <- crime_total["합계", -c(1,2,90)]
crime_tot
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum <- c(NA, NA, sum[-88], NA, sum[88])
crime_tot
crime_total <- NULL
for (i in 1:length(years)) {
filename <- paste(years[i], "년 범죄발생지.csv", sep="")
ds <- read.csv(filename)
ds <- data.frame(ds)
ds$수집년월 <- years[i]
crime_total <- rbind(crime_total, ds)
}
crime_total$합계 <- rowSums(crime_total[,-c(1,2,90)])
sum <- as.integer(colSums(crime_total[, -c(1,2,90)]))
sum <- c(NA, NA, sum[-88], NA, sum[88])
crime_total
View(crime_total)
crime_total["합", ] <- sum
crime_tot <- t(crime_total["합", -c(1,2,90,91)])
crime_tot
str(crime_tot)
as.data.frame(crime_tot)
a <- as.data.frame(crime_tot)
str(a)
crime_tot <- t(as.data.frame(crime_total["합", -c(1,2,90,91)])
str(crime_tot)
crime_tot <- t(as.data.frame(crime_total["합", -c(1,2,90,91)])
crime_tot <- t(as.data.frame(crime_total["합", -c(1,2,90,91))])
crime_tot <- t(as.data.frame(crime_total["합", -c(1,2,90,91)]))
str(crime_tot)
crime_tot <- t(crime_total["합", -c(1,2,90,91)])
str(crime_tot)
crime_tot <- as.data.frame(crime_tot)
str(crime_tot)
crime_tot
crime_tot["서울", ]
crime_tot["경기", ] <- sum(crime_tot[c("경기.고양":"경기.화성"), ])
crime_tot["경기.화성", ]
dim(crime_tot)
idx <- c(1:87)
crime_ctry <- data.frame(idx, crime_tot)
crime_ctry)
crime_ctry
crime_tot[5]
crime_tot[5,]
crime_cty <- data.frame(idx, crime_tot)
crime_cty
dim(crime_tot)
crime_tot <- as.data.frame(crime_tot)
crime_tot
crime_tot[20, ]
crime_tot[30, ]
crime_tot["경기", ] <- crime_tot[c(9:36),]
crime_tot[c(9:36),]
crime_tot["경기", ] <- sum(crime_tot[c(9:36), ])
crime_tot
crime_tot["강원", ] <- sum(crime_tot[c(37:42), ])
crime_tot["충북", ] <- sum(crime_tot[c(43,44,45), ])
crime_tot[84]
crime_tot[84, ]
crime_tot[76, ]
crime_tot[66, ]
crime_tot[54, ]
crime_tot[46, ]
crime_tot[37, ]
crime_tot[43, ]
crime_tot["경기", ] <- sum(crime_tot[c(9:36), ])
crime_tot["강원", ] <- sum(crime_tot[c(37:43), ])
crime_tot["충북", ] <- sum(crime_tot[c(44,45,46), ])
crime_tot["충남", ] <- sum(crime_tot[c(47:54), ])
crime_tot["전북", ] <- sum(crime_tot[c(55:60), ])
crime_tot["전남", ] <- sum(crime_tot[c(61:65), ])
crime_tot["경북", ] <- sum(crime_tot[c(66:75), ])
crime_tot["경남", ] <- sum(crime_tot[c(76:83), ])
crime_tot["제주", ] <- sum(crime_tot[c(84,85), ])
crime_tot
crime_ctr <- crime_tot[-c(9:85), ]
crime_ctr
crime_ctr <- data.frame()
crime_ctr <- crime_tot[-c(9:85), ]
crime_ctr
crime_tot
str(crime_tot)
crime_ctr <- as.data.frame(crime_tot[-c(9:85), ])
crime_ctr
crime_tot[-c(9:85), ]
crime_tot[-1, ]
crime_tot
crime_tot[-1, ]
crime_tot
crime_tot <- crime_total["합", -c(1,2,90,91)]
crime_tot
crime_tot <- crime_total[, -c(1,2,90,91)]
crime_tot
str(crime_tot)
crime_tot <- crime_total["합", -c(1,2,90,91)]
str(crime_tot)
crime_tot
str(crime_tot)
crime_tot["경기.고양":"경기.광주", ]
crime_total[, c("경기.고양":"경기.김포")]
crime_total[, c("경기.김포")]
dim(crime_total)
crime_tot
crime_region <[-c(9:85), ]
crime_region <- crime_tot[-c(9:85), ]
crime_region
crime_tot
crime_total["합", ] <- sum
crime_tot <- crime_total["합", -c(1,2,90,91)]
crime_tot
str(crime_tot)
crime_region <- crime_tot[, -c(9:85)]
crime_region
crime_tot["경기", ] <- sum(crime_tot[c(9:36), ])
crime_tot["강원", ] <- sum(crime_tot[c(37:43), ])
crime_tot["충북", ] <- sum(crime_tot[c(44,45,46), ])
crime_tot["충남", ] <- sum(crime_tot[c(47:54), ])
crime_tot["전북", ] <- sum(crime_tot[c(55:60), ])
crime_tot["전남", ] <- sum(crime_tot[c(61:65), ])
crime_tot["경북", ] <- sum(crime_tot[c(66:75), ])
crime_tot["경남", ] <- sum(crime_tot[c(76:83), ])
crime_tot["제주", ] <- sum(crime_tot[c(84,85), ])
crime_region <- crime_tot[, -c(9:85)]
crime_region
crime_total["합", ] <- sum
crime_tot <- crime_total["합", -c(1,2,90,91)]
crime_tot
crime_tot[, "경기"] <- sum(crime_tot[c(9:36), ])
crime_tot[, "강원"] <- sum(crime_tot[c(37:43), ])
crime_tot[, "충북"] <- sum(crime_tot[c(44,45,46), ])
crime_tot[, "충남"] <- sum(crime_tot[c(47:54), ])
crime_tot[, "전북"] <- sum(crime_tot[c(55:60), ])
crime_tot[, "전남"] <- sum(crime_tot[c(61:65), ])
crime_tot[, "경북"] <- sum(crime_tot[c(66:75), ])
crime_tot[, "경남"] <- sum(crime_tot[c(76:83), ])
crime_tot[, "제주"] <- sum(crime_tot[c(84,85), ])
crime_region <- crime_tot[, -c(9:85)]
crime_region
crime_total["합", ] <- sum
crime_tot <- crime_total["합", -c(1,2,90,91)]
crime_tot
crime_tot[, "경기"] <- sum(crime_tot[, c(9:36)])
crime_tot[, "강원"] <- sum(crime_tot[, c(37:43)])
crime_tot[, "충북"] <- sum(crime_tot[, c(44,45,46)])
crime_tot[, "충남"] <- sum(crime_tot[, c(47:54)])
crime_tot[, "전북"] <- sum(crime_tot[, c(55:60)])
crime_tot[, "전남"] <- sum(crime_tot[, c(61:65)])
crime_tot[, "경북"] <- sum(crime_tot[, c(66:75)])
crime_tot[, "경남"] <- sum(crime_tot[, c(76:83)])
crime_tot[, "제주"] <- sum(crime_tot[, c(84,85)])
crime_region <- crime_tot[, -c(9:85)]
crime_region
crime_region <- t(crime_tot[, -c(9:85)])
crime_region
crime_region <- crime_region[order(crime_region$합, decreasing=T), ]
crime_region$합합
```
crime_region$합
```
str(crime_region)
crime_region <- crime_tot[, -c(9:85)]
str(crime_region)
crime_region <- crime_region[order(crime_region$합, decreasing=T), ]
crime_region
crime_region <- crime_region[order(crime_region["합", ], decreasing=T), ]
crime_region
t(crime_region)
crime_region <- crime_tot[, -c(9:85)]
t(crime_region)
str(t(crime_region))
crime_region$합합
crime_region$합
```
crime_region <- crime_tot[, -c(9:85)]
crime_region <- crime_region[order(crime_region, decreasing=T), ]
crime_region
crime_region <- crime_tot[, -c(9:85)]
crime_region
crime_region <- crime_region[order(crime_region, decreasing=T), ]
crime_region
order(crime_region, decreasing=T)
crime_region <- crime_tot[, -c(9:85)]
crime_region
order(crime_region)
order(crime_region, decreasing=F)
order(crime_region, decreasing=T)
crime_region <- crime_region[order(crime_region, decreasing=T), ]
crime_region
crime_region <- crime_tot[, -c(9:85)]
order(crime_region, decreasing=T)
crime_region[11, ]
crime_region <- crime_region[, order(crime_region, decreasing=T)]
crime_region
crime_region <- crime_tot[, -c(9:85)]
crime_region <- crime_region[, order(crime_region, decreasing=T)]
crime_region
crime_region
# k-means clustering
std <- function(X) {
return((X-min(X)) / (max(X)-min(X)))
}
mydata <- apply(state.x77, 2, FUN=std)
fit <- kmeans(x=mydata, centers=5)
library(cluster)
clusplot(mydata, fit$cluster, color=T, shade=T,
labels=1, lines=0)
